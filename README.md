# Gas Station Customer Synthesis ML Project

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ —Å–∏–Ω—Ç–µ–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –ê–ó–° —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –≥–∏–ø–æ—Ç–µ–∑ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º.

**–ö–µ–π—Å –æ—Ç –ü–ê–û "–ì–∞–∑–ø—Ä–æ–º –Ω–µ—Ñ—Ç—å"**

## üìã –ó–∞–¥–∞—á–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–µ—Ç–æ–¥–∏–∫—É –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ò–ò-–¥–≤–æ–π–Ω–∏–∫–æ–≤) - –æ–ø–∏—Å–∞–Ω–∏–π —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª, –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ —Å –∏—Ö –ø–æ–º–æ—â—å—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±–µ–∑–ª–∏—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –Ω–∞–±–æ—Ä –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ —Å –∏–∑–º–µ—Ä–∏–º—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ –∏ —Ä–µ–∞–∫—Ü–∏—è–º–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∞–∫—Ü–∏–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, UX), —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–∏–ø–æ—Ç–µ–∑—ã –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º, –±–µ–∑ –±–æ–ª—å—à–∏—Ö –∑–∞—Ç—Ä–∞—Ç –≤—Ä–µ–º–µ–Ω–∏.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –ú–æ–¥–µ–ª—å –ø–æ—Ä—Ç—Ä–µ—Ç–∞
- –ê—Ç—Ä–∏–±—É—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞
- –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (–≤—Ä–µ–º—è, –ø–æ–≥–æ–¥–∞/—Å–µ–∑–æ–Ω, –æ—á–µ—Ä–µ–¥–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å—Ç–∞–Ω—Ü–∏–∏)
- –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π

### 2. –ú–∞–ø–ø–∏–Ω–≥ –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤
- –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- –ê–ª–≥–æ—Ä–∏—Ç–º –æ—Ç–Ω–µ—Å–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –ø–æ—Ä—Ç—Ä–µ—Ç–∞–º

### 3. –ü—Ä–∞–≤–∏–ª–∞ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Ñ–∏—á–∏
- –ú–æ–¥–µ–ª–∏ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è

### 4. –î–∏–∑–∞–π–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ A/B —Ç–µ—Å—Ç–æ–≤
- –û—Ü–µ–Ω–∫–∞ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.8+**
- **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**: scikit-learn, pandas, numpy
- **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**: K-means, DBSCAN, Hierarchical clustering
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: matplotlib, seaborn, plotly
- **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã**: scipy, statsmodels
- **API**: FastAPI
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL/SQLite

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
gas-station-ML/
‚îú‚îÄ‚îÄ data/                   # –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ models/            # ML –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ clustering/        # –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ personas/          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ experiments/       # –î–∏–∑–∞–π–Ω —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ api/              # REST API
‚îú‚îÄ‚îÄ notebooks/             # Jupyter notebooks –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –î–µ–ø–ª–æ–π –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–æ (Docker Compose)
```bash
docker compose up --build
# Swagger: http://127.0.0.1:8000/docs
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ Docker)
```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
bash run_api.sh
```

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω (CI/CD ‚Üí —Å–µ—Ä–≤–µ—Ä Ubuntu 24)
–ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker –∏ Compose –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏
- –ö–ª–æ–Ω–∏—Ä—É–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ó–∞–ø—É—Å–∫–∞–µ—Ç `docker compose up --build -d`
- API –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞: http://185.221.199.232:8000

## üìä –ü—Ä–∏–º–µ—Ä—ã API-–∑–∞–ø—Ä–æ—Å–æ–≤

### 1) –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è K-Means
```bash
curl -X POST http://185.221.199.232:8000/api/v1/segmentation/kmeans \
  -H "Content-Type: application/json" \
  -d '{
    "data": [
      {"visits_per_month": 7.2, "avg_ticket": 1900, "fuel_regular_share": 0.7, "fuel_diesel_share": 0.2, "services_shop": 0.5, "services_cafe": 0.2},
      {"visits_per_month": 3.1, "avg_ticket": 1400, "fuel_regular_share": 0.3, "fuel_diesel_share": 0.5, "services_shop": 0.2, "services_cafe": 0.1}
    ],
    "features": ["visits_per_month","avg_ticket","fuel_regular_share","fuel_diesel_share","services_shop","services_cafe"],
    "n_clusters": 3
  }'
```

### 2) –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
```bash
curl -X POST http://185.221.199.232:8000/api/v1/personas/from-clusters \
  -H "Content-Type: application/json" \
  -d '{
    "data": [
      {"visits_per_month": 7.2, "avg_ticket": 1900, "fuel_regular_share": 0.7, "fuel_diesel_share": 0.2, "services_shop": 0.5, "services_cafe": 0.2},
      {"visits_per_month": 3.1, "avg_ticket": 1400, "fuel_regular_share": 0.3, "fuel_diesel_share": 0.5, "services_shop": 0.2, "services_cafe": 0.1}
    ],
    "labels": [0,1],
    "n_personas": 2
  }'
```

### 3) –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ä—Ç—Ä–µ—Ç –ø–æ id
```bash
curl http://185.221.199.232:8000/api/v1/personas/<persona_id>
```

### 4) –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å A/B —Ç–µ—Å—Ç
```bash
curl -X POST http://185.221.199.232:8000/api/v1/experiments/design \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ü–µ—Ä—Å. —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
    "description": "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –∫–∞—Å—Å–µ",
    "target_metric": "conversion_rate",
    "expected_effect_size": 0.07,
    "affected_personas": ["<persona_id_1>", "<persona_id_2>"],
    "feature_description": "UI-–∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π",
    "business_context": "–ü–æ–≤—ã—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏"
  }'
```

### 5) –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
```bash
curl -X POST http://185.221.199.232:8000/api/v1/experiments/<experiment_id>/simulate
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

1. **–ù–∞–±–æ—Ä –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤** —Å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Ä–µ–∞–∫—Ü–∏–∏
2. **–ê–ª–≥–æ—Ä–∏—Ç–º –º–∞–ø–ø–∏–Ω–≥–∞** —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –ø–æ—Ä—Ç—Ä–µ—Ç–∞–º
3. **–ú–∞—Ç—Ä–∏—Ü–∞ –≥–∏–ø–æ—Ç–µ–∑** —Å –ø–ª–∞–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –æ–∂–∏–¥–∞–µ–º—ã–º –≤–ª–∏—è–Ω–∏–µ–º –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏
4. **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–¥—Ö–æ–¥–æ–≤

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

### –î–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã —Å–µ—Ç–∏ –ê–ó–° ¬´–ì–∞–∑–ø—Ä–æ–º–Ω–µ—Ñ—Ç—å¬ª:
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –∫–∞—Å—Å–µ
- –ü—Ä–æ–≥–Ω–æ–∑ –æ—á–µ—Ä–µ–¥–µ–π
- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–Ω—Ü–∏–∏ –ø–æ –ø—É—Ç–∏
- –í—ã–±–æ—Ä —Ü–µ–ª–µ–≤—ã—Ö –≥—Ä—É–ø–ø –¥–ª—è A/B —Ç–µ—Å—Ç–æ–≤
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ —Ñ–∏—á–∏
- –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∏ –Ω–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏–π

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

### 1. –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
- –ü–æ—Ä—Ç—Ä–µ—Ç—ã –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∏–ø–æ—Ç–µ–∑
- –ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

### 2. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ —Å–µ–≥–º–µ–Ω—Ç

### 3. –ö–∞—á–µ—Å—Ç–≤–æ
- –ü–æ–∫—Ä—ã—Ç–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π
- –¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
pytest -v tests/
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

---

**–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫–µ–π—Å–∞ –ü–ê–û "–ì–∞–∑–ø—Ä–æ–º –Ω–µ—Ñ—Ç—å" –¥–ª—è —Ç—Ä–µ–∫–∞ "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã"**